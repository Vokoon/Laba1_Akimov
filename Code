import pandas as pd
from openpyxl import load_workbook
import openpyxl
!wget  -O 'base_demo.xlsx' #название файла
data = pd.read_excel('base_demo.xlsx') #название файла
data1  = pd.read_excel('base.xlsx') #название файла
data

# Сортировка
print("Введите название таблицы для сортировки")
sorted_data_asc = data.sort_values(by=input(), ascending=True) #Год начала модели
print(sorted_data_asc)

#Выводим Строки с опр.Элементом
data.loc[data[input("Введите столбец: ")] == input("Введите элемент из таблицы: ")] #На месте Марка(1) любой столбец из Таблицы. На месте AC(2) любой элемент из таблицы
print(data)

# Удаление строки/Столбца
data1 = load_workbook('base_demo.xlsx') # Открываем файл Excel
sheet = data1.active # Выбираем активный лист
row_number = 1296 # Указываем номер строки, которую нужно удалить
sheet.delete_rows(row_number) # Удаляем строку
data1.save('base.xlsx') #Откройте файл base.xlsx и убедитесь что строка под этим номером пропала и была автоматически заменена соседом рядом

#Вывод машин с прошедшым гарантийным сроком
# Загрузка данных из таблицы Excel
df = pd.read_excel("base_demo.xlsx")
# Фильтрация машин, созданных до 2000 года
filtered_df = df[df["Год начала поколения"] < 2000]
filtered_df

#Добавляем новую строку в Таблицу
data2 = load_workbook('base_demo.xlsx') # Исходная таблица
sheet = data2.active # Выбираем активный лист
new_row=('AA', 'AA', 'AA', 'Да') #Даём информацию для новой строки, значения могут быть любые, но знайте (,) разделяет значения по столбцам
sheet.append(new_row)
data2.save('base.xlsx') #Откройте файл base.xlsx и убедитесь что строка под этим номером пропала и была автоматически заменена соседом рядом


# Заменяем значения в любой строке и любом столбце
data3 = openpyxl.load_workbook('base_demo.xlsx')
worksheet = data3['cars-base.ru']
row_index=2
worksheet.cell(row=row_index, column=6).value = 'ACE'
data3.save('base.xlsx') #Откройте файл base.xlsx и убедитесь что строка под этим номером пропала и была автоматически заменена соседом рядом

# data.to_excel('путь_к_файлу.xlsx', index=False) Можно сохранить изменения
